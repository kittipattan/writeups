# STH Mini Web CTF 2025 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà¬†1

![‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡πÄ‡∏û‡∏à Siam Thanat Hack Co.,¬†Ltd.][promote_picture]

‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏ú‡∏π‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏ó‡πà‡∏≤‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏ú‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏´‡πá‡∏ô‡πÉ‡∏ô‡πÄ‡∏û‡∏à Facebook ‡∏Ç‡∏≠‡∏á‡∏ö‡∏à‡∏Å. ‡∏™‡∏¢‡∏≤‡∏°‡∏ñ‡∏ô‡∏±‡∏î‡πÅ‡∏Æ‡∏Å (Siam Thanat Hack Co., Ltd.) ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô Mini Web CTF ‡πÄ‡∏•‡∏¢‡∏™‡∏ô‡πÉ‡∏à‡∏•‡∏≠‡∏á‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏î‡∏π‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ú‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ö‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏î‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö üôè

‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏°‡∏µ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

> - ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ Flag ‡πÇ‡∏î‡∏¢ Flag ‡∏à‡∏∞‡∏°‡∏µ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö ‡πÄ‡∏ä‡πà‡∏ô STH1{cff940beed74db5e1c7c63007223a6e6}
> - ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö (Flag 1)
> - ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö (Flag 2)

‡πÇ‡∏î‡∏¢‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡πÉ‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ https://web1.ctf.p7z.pw

---

## TL;DR
- ‡∏î‡∏∂‡∏á credential ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å comment ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô HTML source code ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô ‡πÑ‡∏õ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÄ‡∏õ‡πá‡∏ô user ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤
- ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ function ‡∏ó‡∏µ‡πà‡πÄ‡∏à‡∏≠‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• username ‡πÅ‡∏•‡∏∞ `remember_me_token` ‡∏Ç‡∏≠‡∏á admin
- ‡∏ï‡∏≠‡∏ô‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô user ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡πÉ‡∏´‡πâ‡∏ï‡∏¥‡πâ‡∏Å "Remember Me" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤ `remember_me` ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏ô cookie
- ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ crack JWT ‡πÉ‡∏ô cookie `remember_me` ‡∏Ç‡∏≠‡∏á user ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ wordlist `rockyou.txt` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤ secret key ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ sign
- ‡∏™‡∏£‡πâ‡∏≤‡∏á JWT ‡πÉ‡∏´‡∏°‡πà‡πÇ‡∏î‡∏¢‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà payload ‡∏î‡πâ‡∏ß‡∏¢ `remember_me_token` ‡∏Ç‡∏≠‡∏á admin ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ secret key ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ crack ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ sign
- ‡πÉ‡∏ä‡πâ JWT ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤ `index.php` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ã‡πá‡∏ó‡∏Ñ‡πà‡∏≤ `PHPSESSID` ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤ `admin.php` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏ö Flag 1 ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å comment ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô HTML
- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á parameter `amount` ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô POST request ‡∏ï‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏á‡∏¥‡∏ô ‡πÄ‡∏õ‡πá‡∏ô <number>%0ASTH (‡πÄ‡∏ä‡πà‡∏ô 123%0ASTH) ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡πà‡∏á‡πÑ‡∏õ ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡πÑ‡∏î‡πâ Flag 2 ‡∏°‡∏≤
- Flag 1: `STH1{310052ba6883872435f7c5aafa850813}`
- Flag 2: `STH2{d9d2532fd8ad5419450b5ea34ed93f32}`

---

## ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÇ‡∏à‡∏ó‡∏¢‡πå

1. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏£‡∏Å‡∏ú‡∏°‡∏Å‡πá‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏û‡∏ö‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà "Username" ‡∏Å‡∏±‡∏ö "Password" ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏° "Remember Me" ‡πÉ‡∏´‡πâ‡∏Å‡∏î

‡∏ú‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏ã‡πá‡∏ó‡πÉ‡∏´‡πâ request ‡∏ú‡πà‡∏≤‡∏ô Burp Proxy ‡πÑ‡∏ß‡πâ‡∏î‡πâ‡∏ß‡∏¢ ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏õ‡∏î‡∏π HTTP request / response ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å repeat request ‡∏≠‡∏±‡∏ô‡πÑ‡∏´‡∏ô‡∏Å‡πá‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏á‡πà‡∏≤‡∏¢

![‡∏´‡∏ô‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Ñ‡∏≠‡∏¥‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô https://web1.ctf.p7z.pw ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å][image_01]

2. ‡∏ï‡∏≠‡∏ô‡πÅ‡∏£‡∏Å‡∏ú‡∏°‡∏Å‡πá‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà fuzz ‡∏´‡∏≤ directory ‡∏Ñ‡∏£‡∏±‡∏ö ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡πà‡∏≤ (‡∏Å‡∏•‡∏±‡∏ß‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏≠‡∏Å‡πÄ‡∏´‡∏ô‡∏∑‡∏≠ scope ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ‡∏ó‡∏≥‡πÄ‡∏ß‡πá‡∏ö‡∏•‡πà‡∏° 5555) ‡∏ú‡∏°‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡∏°‡∏≤‡∏î‡∏π‡∏ó‡∏µ‡πà HTML source code ‡∏Å‡πà‡∏≠‡∏ô ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤‡∏°‡∏µ comment ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏≤

‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡πÄ‡∏à‡∏≠ credential ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å comment ‡πÑ‡∏ß‡πâ

```html
<!-- Credentials: username 'test', password 'test' -->
```

![HTML source code ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Ñ‡∏≠‡∏¥‡∏ô][image_02]

3. ‡∏ú‡∏°‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡πÄ‡∏≠‡∏≤ credential ‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏•‡πá‡∏≠‡∏Ñ‡∏≠‡∏¥‡∏ô ‡∏ú‡∏•‡∏Ñ‡∏∑‡∏≠‡∏•‡πá‡∏≠‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÅ‡∏•‡∏∞‡∏ñ‡∏π‡∏Å redirect ‡∏°‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ `userinfo.php` ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á user `test`

![‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏û‡∏à /userinfo.php ‡∏Ç‡∏≠‡∏á user¬†`test`][image_03]

4. ‡∏û‡∏≠‡∏•‡∏≠‡∏á‡∏°‡∏≤‡∏î‡∏π‡πÉ‡∏ô HTML source code ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ `userinfo.php` ‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ JavaScript ‡∏à‡∏≤‡∏Å‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `script.js`

![HTML source code ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ /userinfo.php][image_04]

‡∏ú‡∏°‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏î‡∏π‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å‡πÅ‡∏ñ‡∏ö "Sources" ‡∏Ç‡∏≠‡∏á "Developer Tools" ‡πÉ‡∏ô browser ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡πÄ‡∏´‡πá‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á

```javascript
// script.js

document.addEventListener('DOMContentLoaded', () => {
  // Fetch the current user's information from the API
  fetch('api.php?action=get_userinfo')
    .then(response => response.json())
    .then(data => {
      if (data.username) {
        // Populate the page with user info
        document.getElementById('username').textContent = data.username;
        document.getElementById('role').textContent = data.role;
        document.getElementById('status').textContent = data.status;
      } else if (data.error) {
        console.error('API Error:', data.error);
      } else {
        console.error('Unexpected response format.');
      }
    })
    .catch(err => {
      console.error('Error fetching user info:', err);
    });
});

function debugFetchUserTest() {
  fetch('api.php?action=get_userinfo&user=test')
    .then(response => response.json())
    .then(data => {
      console.log('Debug get_userinfo for user=test:', data);
    })
    .catch(err => {
      console.error('Error in debugFetchUserTest:', err);
    });
}

function debugFetchAllUsers() {
  // admin.php
  fetch('api.php?action=get_alluser')
    .then(response => response.json())
    .then(data => {
      console.log('Debug get_alluser result:', data);
    })
    .catch(err => {
      console.error('Error in debugFetchAllUsers:', err);
    });
}
```

5. ‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡πÉ‡∏ô `script.js` ‡∏°‡∏µ‡∏Å‡∏≤‡∏£ fetch ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å `/api.php?action=get_userinfo` ‡∏ú‡∏°‡∏Å‡πá‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡πÑ‡∏õ‡∏î‡∏π HTTP request ‡∏ô‡∏µ‡πâ‡πÉ‡∏ô Burp Proxy ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏ß‡πá‡∏ö response ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á user `test` ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà `username`, `role`, `remember_me_token`, ‡πÅ‡∏•‡∏∞ `status`

![HTTP request ‡πÅ‡∏•‡∏∞ response ‡∏à‡∏≤‡∏Å /api.php?action=get_userinfo][image_05_1]

‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏µ‡∏≠‡∏µ‡∏Å 2 functions ‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠:
- `debugFetchUserTest()`‚Ää-‚Ää‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á user `test`
- `debugFetchAllUsers()`- ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ user ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ request ‡πÑ‡∏õ‡∏ó‡∏µ‡πà path ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏ß‡πâ‡πÉ‡∏ô function ‡∏ï‡∏£‡∏á ‡πÜ ‡πÄ‡∏•‡∏¢‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡∏ú‡∏°‡∏•‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ function ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏î‡∏π‡∏Å‡πà‡∏≠‡∏ô‡∏ú‡πà‡∏≤‡∏ô "Console" ‡∏Ç‡∏≠‡∏á "Developer Tools" ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏î‡∏±‡∏á‡∏£‡∏π‡∏õ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á

![‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ `debugFetchAllUsers()` ‡πÅ‡∏•‡∏∞ `debugFetchUserTest()`][image_05_2]

‡∏≠‡∏µ‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏ú‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡πÉ‡∏ô `debugFetchAllUsers()` ‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏ô‡πâ‡∏≤ `admin.php` ‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô comment ‡∏ú‡∏°‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏î‡∏π ‡πÅ‡∏ï‡πà‡∏Å‡πá‡πÇ‡∏î‡∏ô redirect ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤ ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå admin ‡∏Å‡πà‡∏≠‡∏ô

6. ‡∏à‡∏≤‡∏Å function ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ username ‡∏ó‡∏µ‡πà‡∏î‡∏π‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á admin ‡∏°‡∏≤‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ `admin-uat` ‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠ `user` ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô parameter user ‡∏Ç‡∏≠‡∏á `/api.php?action=get_userinfo&user=<username>` ‡πÑ‡∏î‡πâ ‡∏ú‡∏°‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏∏ username ‡∏Ç‡∏≠‡∏á admin ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö ‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ß‡πà‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á `admin-uat` ‡∏°‡∏≤‡πÑ‡∏î‡πâ

![HTTP request ‡πÅ‡∏•‡∏∞ response ‡∏à‡∏≤‡∏Å /api.php?action=get_userinfo&user=admin-uat][image_06]

7. ‡∏ï‡∏≠‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏≤‡∏ß‡πà‡∏≤ `remember_me_token` ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô‡πÑ‡∏î‡πâ‡∏ö‡πâ‡∏≤‡∏á ‡πÅ‡∏•‡∏∞‡∏ô‡∏∂‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏°‡∏µ "Remember Me" ‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏≠‡∏¢‡∏π‡πà ‡∏ú‡∏°‡∏Å‡πá‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡πÑ‡∏õ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡∏Å‡∏î‡πÉ‡∏´‡πâ "Remember Me" ‡∏î‡πâ‡∏ß‡∏¢ ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏ã‡πá‡∏ó‡∏Ñ‡πà‡∏≤ `remember_me` ‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÉ‡∏ô cookie

![HTTP request ‡πÅ‡∏•‡∏∞ response ‡∏à‡∏≤‡∏Å‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á user `test` ‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡πä‡∏Å "Remember Me"][image_07]

8. ‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏≤ `remember_me` ‡πÅ‡∏•‡πâ‡∏ß ‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô JWT ‡∏ú‡∏°‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡πÑ‡∏õ decode ‡πÉ‡∏ô‡πÄ‡∏ß‡πá‡∏ö jwt.io ‡∏î‡∏π ‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ß‡πà‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ decode ‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡πÉ‡∏ô payload ‡∏°‡∏µ key ‡∏ä‡∏∑‡πà‡∏≠ `token` ‡∏≠‡∏¢‡∏π‡πà ‡∏ã‡∏∂‡πà‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö `remember_me_token` ‡∏Ç‡∏≠‡∏á user `test` ‡∏û‡∏≠‡∏î‡∏µ

![‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏Ñ‡πà‡∏≤ `remember_me` ‡πÑ‡∏õ JWT¬†decode][image_08]

9. ‡∏ó‡∏µ‡∏ô‡∏µ‡πâ‡∏ú‡∏°‡∏Å‡πá‡∏•‡∏≠‡∏á‡∏ó‡∏≥ JWT attacks ‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏°‡∏≤‡∏ö‡πâ‡∏≤‡∏á‡πÉ‡∏ô PortSwigger ‡∏ú‡∏°‡πÑ‡∏î‡πâ‡∏•‡∏≠‡∏á‡∏ó‡∏≥‡∏™‡∏≠‡∏á‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡∏∑‡∏≠:
- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏Ñ‡πà‡∏Ñ‡πà‡∏≤ `token` ‡πÉ‡∏ô JWT payload ‡πÅ‡∏•‡∏∞‡∏õ‡∏•‡πà‡∏≠‡∏¢ header ‡∏Å‡∏±‡∏ö signature ‡πÑ‡∏ß‡πâ‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏° ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏µ‡∏Å‡∏≤‡∏£ verify signature ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏î‡∏µ ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏•‡∏¢
- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô algorithm `alg` ‡πÉ‡∏ô header ‡πÄ‡∏õ‡πá‡∏ô `none` ‡∏´‡∏£‡∏∑‡∏≠ `nOnE` ‡πÅ‡∏•‡∏∞ payload ‡πÅ‡∏•‡∏∞‡∏•‡∏ö signature ‡∏≠‡∏≠‡∏Å ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö JWT ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ signature

‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á request ‡πÑ‡∏õ‡∏ó‡∏µ‡πà `/index.php` ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡πà‡∏≤ `remember_me` ‡πÑ‡∏õ‡πÉ‡∏ô cookie ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏î‡∏π response ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ token ‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡πÇ‡∏î‡∏¢‡∏ñ‡πâ‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ ‡∏ï‡∏±‡∏ß‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞ redirect ‡πÄ‡∏£‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ `userinfo.php` ‡∏Ç‡∏≠‡∏á user ‡∏ô‡∏±‡πâ‡∏ô

![HTTP response ‡πÄ‡∏°‡∏∑‡πà‡∏≠ JWT ‡∏ô‡∏±‡πâ‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ][image_09_1]

‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ token ‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏î‡πâ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞ response ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô

![HTTP repsonse ‡πÄ‡∏°‡∏∑‡πà‡∏≠ JWT ‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ][image_09_2]

‡∏ú‡∏•‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ß‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ ‡∏ú‡∏°‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ñ‡∏∑‡∏≠ brute-force ‡∏´‡∏≤ secret key ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ sign ‡πÄ‡∏•‡∏¢

10. ‡∏ú‡∏°‡∏•‡∏≠‡∏á brute-force ‡∏´‡∏≤ JWT secret key ‡∏Ç‡∏≠‡∏á user `test` ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ `hashcat` ‡πÄ‡∏ã‡πá‡∏ó Attack mode ‡πÄ‡∏õ‡πá‡∏ô `-a 0` ‡πÅ‡∏•‡∏∞ Hash mode ‡πÄ‡∏õ‡πá‡∏ô `-m 16500` (JWT) ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ wordlist ‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°‡∏Ñ‡∏∑‡∏≠ `rockyou`

```bash
hashcat -a 0 -m 16500 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbiI6ImI4MTk0M2JhLWQxYzUtNDk1YS04NDI3LTQ3MTFjMzkyNTZiZiJ9.Rlk_a69lx16hNhwn4nBfRxhiMGmEDoPIcxfr1_7JdH8' /usr/share/wordlists/rockyou.txt
```

‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ß‡πà‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ brute-force ‡πÑ‡∏î‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏™‡πà‡∏ß‡∏ô secret key ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ sign ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ `"bobcats"` (‡∏°‡∏µ " ‡∏î‡πâ‡∏ß‡∏¢ ‡∏ï‡∏≠‡∏ô‡πÅ‡∏£‡∏Å‡∏ú‡∏°‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÅ‡∏Ñ‡πà bobcats 5555)

![‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å hashcat ‡∏ß‡πà‡∏≤‡πÄ‡∏à‡∏≠ secret key ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á][image_10]

11. ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏ú‡∏°‡∏Å‡πá‡∏™‡∏£‡πâ‡∏≤‡∏á JWT ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤ ‡πÇ‡∏î‡∏¢‡πÅ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô payload ‡πÄ‡∏õ‡πá‡∏ô `remember_me_token` ‡∏Ç‡∏≠‡∏á `admin-uat` ‡πÅ‡∏•‡∏∞ sign ‡∏î‡πâ‡∏ß‡∏¢ secret key ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á brute-force ‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô

‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á JWT ‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ ‡πÅ‡∏ï‡πà‡∏ú‡∏°‡πÉ‡∏ä‡πâ JSON Web Tokens Extension ‡πÉ‡∏ô Burp Suite ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ JWT ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á request ‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö

![‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á JWT ‡∏î‡πâ‡∏ß‡∏¢ Extension ‡πÉ‡∏ô Burp Suite ‡πÅ‡∏•‡∏∞ HTTP response¬†‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö][image_11_1]

‡∏û‡∏≠‡πÉ‡∏ä‡πâ JWT ‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô `remember_me` cookie ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà `/index.php` ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ñ‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡∏£‡∏∞‡∏ö‡∏ö redirect ‡πÑ‡∏õ‡∏ó‡∏µ‡πà `userinfo.php` ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤ JWT ‡∏ô‡∏µ‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡∏∞‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ `userinfo.php` ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡πÄ‡∏õ‡πá‡∏ô `admin-uat` ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢

![‡∏´‡∏ô‡πâ‡∏≤ /userinfo.php ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô `admin-uat` ‡πÑ‡∏î‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à][image_11_2]

12. ‡∏û‡∏≠‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô admin ‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏ú‡∏°‡∏Å‡πá‡∏•‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ `admin.php` ‡πÉ‡∏´‡∏°‡πà (‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏à‡∏≠‡πÉ‡∏ô `script.js`) ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πá‡∏™‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à

![‡∏´‡∏ô‡πâ‡∏≤ /admin.php][image_12_1]

‡∏û‡∏≠‡∏°‡∏≤‡∏î‡∏π‡πÉ‡∏ô HTML source code ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏û‡∏à ‡∏Å‡πá‡∏à‡∏∞‡πÑ‡∏î‡πâ Flag ‡∏ó‡∏µ‡πà 1 ‡∏°‡∏≤

![HTML source code ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ /admin.php][image_12_2]

### Flag 1:

```
STH1{310052ba6883872435f7c5aafa850813}
```

13. ‡∏û‡∏≠‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡∏°‡∏≤‡∏î‡∏π‡πÉ‡∏ô HTML source ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ `admin.php` ‡∏≠‡∏µ‡∏Å ‡∏Å‡πá‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î PHP ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ù‡∏±‡πà‡∏á backend ‡∏ñ‡∏π‡∏Å comment ‡πÑ‡∏ß‡πâ

![HTML source code ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ /admin.php][image_13_1]

```php
function validateNumber($input) {
    if (preg_match('/^[0-9]+$/m', $input)) {
        return true;
    }
    return false;
}

$amount = $_POST['amount'] ?? '';
[...]

if(validateNumber($amount) && strpos($amount, 'STH') ){
    $outputMessage = "Printing $amount $denom ... Completed!<br>";
    $outputMessage .= "Serial Number: <strong>".$_ENV['FLAG2']."</strong>";

}else{
    $outputMessage = 'We need a number, but not a number';
}
```

‡∏û‡∏≠‡∏•‡∏≠‡∏á‡πÑ‡∏õ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ `admin.php` ‡∏à‡∏£‡∏¥‡∏á ‡πÜ ‡∏Å‡πá‡∏û‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î PHP ‡∏ó‡∏µ‡πà‡πÄ‡∏à‡∏≠‡πÄ‡∏•‡∏¢ ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ "We need a number, but not a number"

![‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏™‡πà‡πÄ‡∏•‡∏Ç‡∏≠‡∏∞‡πÑ‡∏£‡∏•‡∏á‡πÑ‡∏õ‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î¬†"Print"][image_13_2]

14. ‡∏û‡∏≠‡∏•‡∏≠‡∏á‡∏°‡∏≤‡∏î‡∏π‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î PHP ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ input (‡∏Ñ‡πà‡∏≤ `amount` ‡πÉ‡∏ô POST request) ‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏≠‡∏á function:
- `validateNumber($amount)`‚Ää-‚Ää‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÉ‡∏™‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢ Regex `/^[0‚Äì9]+$/m` ‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏•‡∏Ç 0‚Äì9, 1 ‡∏ï‡∏±‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ
- `strpos($amount, 'STH')`‚Ää-‚Ääreturn ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "STH" ‡πÉ‡∏ô‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏™‡πà‡∏á‡πÑ‡∏õ ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠‡∏Å‡πá return `false`

‡∏ú‡∏°‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏®‡∏∂‡∏Å‡∏©‡∏≤ Regex ‡πÑ‡∏ß‡πâ‡πÄ‡∏•‡∏¢ (üò≠) ‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏®‡∏∂‡∏Å‡∏©‡∏≤ Regex ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡πà‡∏≤ pattern ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏°‡∏±‡∏ô match ‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á ‡∏Å‡πá‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡πÑ‡∏õ‡∏î‡∏π‡πÉ‡∏ô‡πÄ‡∏ß‡πá‡∏ö regexr.com ‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏î‡∏±‡∏á‡∏£‡∏π‡∏õ

![‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ regex ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î PHP ‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡πá‡∏ö regexr.com][image_14_1]

‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡∏Ñ‡∏∑‡∏≠ Multiline flag (`m`) ‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏á‡∏ú‡∏•‡πÉ‡∏´‡πâ `^` ‡∏Å‡∏±‡∏ö `$` ‡∏ó‡∏µ‡πà‡∏õ‡∏Å‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞ match ‡∏ï‡∏±‡∏ß‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏ï‡∏±‡∏ß‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á string ‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô match ‡∏Ç‡∏≠‡∏á**‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î**‡πÅ‡∏ó‡∏ô

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡πÉ‡∏™‡πà input ‡πÄ‡∏õ‡πá‡∏ô `123<newline>STH`:
- ‡∏õ‡∏Å‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ `m` ‡∏°‡∏±‡∏ô‡∏à‡∏∞‡πÑ‡∏õ match ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á string ‡∏ó‡∏≥‡πÉ‡∏´‡πâ input ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà match (‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏°‡∏µ newline (\n) ‡∏Å‡∏±‡∏ö STH ‡∏≠‡∏¢‡∏π‡πà)

![‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ Multiline flag¬†(m)][image_14_2]

- ‡πÅ‡∏ï‡πà‡∏û‡∏≠‡∏°‡∏µ `m` ‡∏°‡∏±‡∏ô‡∏à‡∏∞‡πÑ‡∏õ match ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÅ‡∏ó‡∏ô ‡∏ó‡∏≥‡πÉ‡∏´‡πâ input ‡∏ô‡∏µ‡πâ match

![‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ Multiline flag¬†(m)][image_14_3]

15. ‡∏ó‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á conditions ‡πÑ‡∏î‡πâ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÉ‡∏î ‡πÜ ‡∏Å‡πá‡πÑ‡∏î‡πâ 0‚Äì9 ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏ï‡∏±‡∏ß + ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà + ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "STH"

‡∏ã‡∏∂‡πà‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏´‡∏£‡∏∑‡∏≠ "STH" ‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏´‡πâ "STH" ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏£‡∏Å ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ strpos() ‡∏à‡∏∞ return ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤ 0 (‡πÄ‡∏à‡∏≠ "STH" ‡πÉ‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏£‡∏Å) ‡∏ó‡∏≥‡πÉ‡∏´‡πâ condition ‡∏ñ‡∏π‡∏Å‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô false

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á input ‡∏ó‡∏µ‡πà‡∏ú‡∏°‡πÉ‡∏ä‡πâ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠

```
123
STH
```

"123" ‡πÉ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÅ‡∏£‡∏Å‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡πà‡∏≤‡∏ô regex ‡πÅ‡∏•‡∏∞ `validateNumber` return true ‡πÅ‡∏•‡∏∞ "STH" ‡πÉ‡∏ô string ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ `strpos` return ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (0, 1, 2,¬†‚Ä¶) ‡∏ã‡∏∂‡πà‡∏á‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà 0 ‡∏Å‡πá‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô true ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á condition ‡πÑ‡∏î‡πâ

16. ‡∏ï‡πà‡∏≠‡∏°‡∏≤‡∏ú‡∏°‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á parameter `amount` ‡πÉ‡∏ô HTTP POST request ‡πÑ‡∏õ‡∏ó‡∏µ‡πà `/admin.php` ‡∏ã‡∏∂‡πà‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏•‡∏á‡πÑ‡∏õ‡πÑ‡∏î‡πâ ‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ URL-encode ‡∏°‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ input ‡πÄ‡∏£‡∏≤‡∏ñ‡∏π‡∏Å interpret ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

‡πÇ‡∏î‡∏¢‡∏ú‡∏°‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡πá‡∏ö CyberChef ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ encode (‡πÉ‡∏ô‡∏ï‡∏≠‡∏ô‡πÅ‡∏£‡∏Å‡∏ú‡∏° encode ‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå `\n` ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ï‡∏£‡∏á ‡πÜ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô‡πÑ‡∏õ encode ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ "\n" ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô newline ‡πÄ‡∏•‡∏¢‡∏ï‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏ô‡∏≤‡∏ô‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö üò≠)

![‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ URL-encode input ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö][image_16]

‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠

```
amount=123%0ASTH&denomination=USD
```

17. ‡∏û‡∏≠‡∏™‡πà‡∏á POST request ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ `amount=123%0ASTH` ‡πÑ‡∏õ ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πá response ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö Flag ‡∏ó‡∏µ‡πà 2 ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏ö‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö

![HTTP POST request ‡πÅ‡∏•‡∏∞ response ‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤ amount ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏î‡∏±‡∏î‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà /admin.php][image_17_1]

![‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏û‡∏à /admin.php ‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á Flag ‡∏ó‡∏µ‡πà 2¬†‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤][image_17_2]

### Flag 2:

```
STH2{d9d2532fd8ad5419450b5ea34ed93f32}
```

---

## ‡∏™‡∏£‡∏∏‡∏õ

‡∏ú‡∏°‡∏Å‡πá‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏≠‡∏∞‡πÑ‡∏£‡∏°‡∏≤‡∏Å‡∏°‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Mini CTF ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô Regex ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£ URL-encode ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏°‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô write-up ‡πÅ‡∏£‡∏Å‡∏î‡πâ‡∏ß‡∏¢ ‡πÅ‡∏•‡∏∞‡∏ú‡∏°‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏ó‡∏≥‡∏ä‡πâ‡∏≤‡∏°‡∏≤‡∏Å ‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏≠‡∏µ‡∏Å‡πÄ‡∏¢‡∏≠‡∏∞ ‡∏ó‡∏≥‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏≠‡∏µ‡∏Å‡πÄ‡∏¢‡∏≠‡∏∞ ‡πÜ ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ó‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ‡∏ú‡∏°‡πÄ‡∏≠‡∏á‡∏Å‡πá‡∏¢‡∏±‡∏á‡∏≠‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏≠‡∏¢‡∏π‡πà‡∏°‡∏≤‡∏Å ‡∏ñ‡πâ‡∏≤‡∏ú‡∏π‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏ó‡πà‡∏≤‡∏ô‡πÉ‡∏î‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞ ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ä‡πà‡∏ô‡∏°‡∏µ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ ‡∏ú‡∏°‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏£‡∏±‡∏ö‡πÑ‡∏ß‡πâ‡∏°‡∏≤‡∏Å ‡πÜ ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏±‡∏ö

‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≤‡∏á‡∏ö‡∏à‡∏Å. ‡∏™‡∏¢‡∏≤‡∏°‡∏ñ‡∏ô‡∏±‡∏î‡πÅ‡∏Æ‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏î‡∏µ ‡πÜ ‡∏ô‡∏µ‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö üôè

---

### ‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå /¬†‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á

- https://jwt.io/
- https://portswigger.net/web-security/jwt
- https://github.com/PortSwigger/json-web-tokens
- https://regexr.com/
- https://gchq.github.io/CyberChef/

[promote_picture]: images/sth_mini_web_ctf_00000.jpg "‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡πÄ‡∏û‡∏à Siam Thanat Hack Co.,¬†Ltd."
[image_01]: images/sth_mini_web_ctf_00001.png "‡∏´‡∏ô‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Ñ‡∏≠‡∏¥‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô https://web1.ctf.p7z.pw ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å"
[image_02]: images/sth_mini_web_ctf_00002_edited.png "HTML source code ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Ñ‡∏≠‡∏¥‡∏ô"
[image_03]: images/sth_mini_web_ctf_00003_edited.png "‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏û‡∏à /userinfo.php ‡∏Ç‡∏≠‡∏á user¬†`test`"
[image_04]: images/sth_mini_web_ctf_00004_edited.png "HTML source code ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ /userinfo.php"
[image_05_1]: images/sth_mini_web_ctf_00005_edited.png "HTTP request ‡πÅ‡∏•‡∏∞ response ‡∏à‡∏≤‡∏Å /api.php?action=get_userinfo"
[image_05_2]: images/sth_mini_web_ctf_00006_edited.png "‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ `debugFetchAllUsers()` ‡πÅ‡∏•‡∏∞ `debugFetchUserTest()`"
[image_06]: images/sth_mini_web_ctf_00007_edited.png "HTTP request ‡πÅ‡∏•‡∏∞ response ‡∏à‡∏≤‡∏Å /api.php?action=get_userinfo&user=admin-uat"
[image_07]: images/sth_mini_web_ctf_00008_edited.png "HTTP request ‡πÅ‡∏•‡∏∞ response ‡∏à‡∏≤‡∏Å‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á user `test` ‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡πä‡∏Å \"Remember Me\""
[image_08]: images/sth_mini_web_ctf_00013_edited.png "‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏Ñ‡πà‡∏≤ `remember_me` ‡πÑ‡∏õ JWT¬†decode"
[image_09_1]: images/sth_mini_web_ctf_00009_edited.png "HTTP response ‡πÄ‡∏°‡∏∑‡πà‡∏≠ JWT ‡∏ô‡∏±‡πâ‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ"
[image_09_2]: images/sth_mini_web_ctf_00010_edited.png "HTTP reponse ‡πÄ‡∏°‡∏∑‡πà‡∏≠ JWT ‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ"
[image_10]: images/sth_mini_web_ctf_00014_edited.png "‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å hashcat ‡∏ß‡πà‡∏≤‡πÄ‡∏à‡∏≠ secret key ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"
[image_11_1]: images/sth_mini_web_ctf_00015_edited.png "‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á JWT ‡∏î‡πâ‡∏ß‡∏¢ Extension ‡πÉ‡∏ô Burp Suite ‡πÅ‡∏•‡∏∞ HTTP response¬†‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö"
[image_11_2]: images/sth_mini_web_ctf_00016_edited.png "‡∏´‡∏ô‡πâ‡∏≤ /userinfo.php ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô `admin-uat` ‡πÑ‡∏î‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"
[image_12_1]: images/sth_mini_web_ctf_00017.png "‡∏´‡∏ô‡πâ‡∏≤ /admin.php"
[image_12_2]: images/sth_mini_web_ctf_00020_edited.png "HTML source code ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ /admin.php"
[image_13_1]: images/sth_mini_web_ctf_00021_edited.png "HTML source code ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ /admin.php"
[image_13_2]: images/sth_mini_web_ctf_00019.png "‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏™‡πà‡πÄ‡∏•‡∏Ç‡∏≠‡∏∞‡πÑ‡∏£‡∏•‡∏á‡πÑ‡∏õ‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î¬†\"Print\""
[image_14_1]: images/sth_mini_web_ctf_00024.png "‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ regex ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î PHP ‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡πá‡∏ö regexr.com"
[image_14_2]: images/sth_mini_web_ctf_00025.png "‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ Multiline flag¬†(m)"
[image_14_3]: images/sth_mini_web_ctf_00026.png "‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ Multiline flag¬†(m)"
[image_16]: images/sth_mini_web_ctf_00027.png "‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ URL-encode input ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö"
[image_17_1]: images/sth_mini_web_ctf_00022_edited.png "HTTP POST request ‡πÅ‡∏•‡∏∞ response ‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤ amount ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏î‡∏±‡∏î‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà /admin.php"
[image_17_2]: images/sth_mini_web_ctf_00023.png "‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏û‡∏à /admin.php ‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á Flag ‡∏ó‡∏µ‡πà 2¬†‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤"